<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Exploration of S&amp;P 500 Index"><meta property="og:title" content="Exploration of S&amp;P 500 Index" />
<meta property="og:description" content="Exploration of S&amp;P 500 Index Using Pandas and Matplotlib In this article we want to explore whether it is true that staying in the market over a longer duration can be lucrative.
Import the Python libraries that are commonly used for data analysis and data exploration such as Pandas and Matplotlib.
In [1]:
import pandas as pd import numpy as np import matplotlib.pyplot as plt  Read the files with S&amp;P 500 data into Pandas dataframes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dragon-library.github.io/library/tutorials/docs/articles/data-science/finance/exploration-stock-index/" />
<meta property="article:published_time" content="2020-01-18T10:42:26+06:00" />
<meta property="article:modified_time" content="2020-01-18T10:42:26+06:00" />
<title>Exploration of S&amp;P 500 Index | Tutorials</title>
<link rel="icon" href="/library/tutorials/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/library/tutorials/book.min.d7931d740642e656222bfe71c31926bed24ceb9fafa2d9069a7a83fa55070bb9.css" integrity="sha256-15MddAZC5lYiK/5xwxkmvtJM65&#43;votkGmnqD&#43;lUHC7k=">


<script defer src="/library/tutorials/en.search.min.45582767a4430dcf6076436affc57b60f578c73419fad19863dc75948f0c0f7c.js" integrity="sha256-RVgnZ6RDDc9gdkNq/8V7YPV4xzQZ&#43;tGYY9x1lI8MD3w="></script>
<!-- highlight -->
  <link rel="stylesheet" href="https://dragon-library.github.io/library/tutorials/plugins/highlight/hybrid.css">


<!-- match-height JS -->
<script src="https://dragon-library.github.io/library/tutorials/plugins/match-height/jquery.matchHeight-min.js"></script>

<!-- highlight -->
<script src="https://dragon-library.github.io/library/tutorials/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://dragon-library.github.io/library/tutorials/"><span>Tutorials</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    

  
  





 
  
    




  
  <ul>
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/python/" >
      Python
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/front-end/bootstrap/basic-bootstap/" >
      Bootstrap 4 แบบพื้นฐาน
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/front-end/javascript/" >
      JavaScript
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/backup/" >
      Backup
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/" >
      Articles
  </a>


    

    




  
  <ul>
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/python/" >
      Python
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/data-science/" >
      Data Sciene
  </a>


    

    




  
  <ul>
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/data-science/pandas/" >
      Pandas
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/data-science/finance/" >
      Finance
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/exploration-stock-index/"  class="active">
      Exploration of S&amp;P 500 Index
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/stock-analysis-in-python/" >
      Stock Analysis in Python
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/cal-stock-return/" >
      Calculate Stock Returns
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/stock-portfolio-analyses-2/" >
      Dash by Plotly
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/intro-stock-analysis-pandas/" >
      Introduction to Stock Analysis using Pandas
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/portfolio-optimization-python/" >
      Portfolio Optimization in Python
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/portfolio-optimization-methods/" >
      Portfolio Optimization Methods
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/yahoo-finance-api_2/" >
      Quantitative Trading Strategies
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/stock-portfolio-analyses-1/" >
      Stock Portfolio Analyses
  </a>

</li>
      
    
      
        <li>

  <a href="/library/tutorials/docs/articles/data-science/finance/yahoo-finance-api_1/" >
      Yahoo &amp; Google Finance API
  </a>

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/data-science/web-scraping/" >
      Web Scraping
  </a>


    

    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/website/" >
      Website
  </a>


    

    






  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/articles/git/" >
      Git
  </a>


    

    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li >
    
      

  <a href="/library/tutorials/docs/book/" >
      Book
  </a>


    

    






  </li>


      
    
  </ul>
  



  











</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/library/tutorials/svg/menu.svg" alt="Menu" />
  </label>
  <strong>Exploration of S&amp;P 500 Index</strong>
</header>

      
<article class="markdown">

<h1 id="exploration-of-s-p-500-index-using-pandas-and-matplotlib">Exploration of S&amp;P 500 Index Using Pandas and Matplotlib</h1>

<p>In this article we want to explore whether it is true that staying in the market over a longer duration can be lucrative.</p>

<p>Import the Python libraries that are commonly used for data analysis and data exploration such as Pandas and Matplotlib.</p>

<p>In [1]:</p>

<pre><code class="language-py">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
</code></pre>

<p>Read the files with S&amp;P 500 data into Pandas dataframes.</p>

<p>In [2]:</p>

<pre><code class="language-py">df1 = pd.read_csv('SP5001.csv')  
df2 = pd.read_csv('SP5002.csv')  
df3 = pd.read_csv('SP5003.csv')
df = pd.concat([df1,df2,df3])
</code></pre>

<p>The dataset has a number of columns such as Open, Close etc. For the purposes of our exploration we will focus only on the Close price since we are interested in trends and not necessarily accuracy of returns.</p>

<p>In [3]:</p>

<pre><code class="language-py">df.head()
</code></pre>

<p><img src="https://miro.medium.com/max/603/1*SsOiGgSupnC8UWCrBjWNDw.png" alt="" /></p>

<p>Take a look at the datatypes</p>

<p>In [4]:</p>

<pre><code class="language-py">df.info()
</code></pre>

<pre><code class="language-py">&lt;class 'pandas.core.frame.DataFrame'&gt;  
Int64Index: 15429 entries, 0 to 118  
Data columns (total 7 columns):  
Adj Close    15429 non-null float64  
Close        15429 non-null float64  
Date         15429 non-null object  
High         15429 non-null float64  
Low          15429 non-null float64  
Open         15429 non-null float64  
Volume       15429 non-null int64  
dtypes: float64(5), int64(1), object(1)  
memory usage: 964.3+ KB
</code></pre>

<p>The datatype of the Date field needs to be converted into datetime64. This will help with plotting and computations as we shall see ahead.</p>

<p>In [5]:</p>

<pre><code class="language-py">df['Date'] = df.loc[:,'Date'].astype('datetime64[ns]')
</code></pre>

<p>Extracting just the fields that we need into a new dataframe with daily data</p>

<p>In [6]:</p>

<pre><code class="language-py">dfd = df[[&quot;Date&quot;, &quot;Close&quot;]]
</code></pre>

<p>Setting the index of the dataframe to date</p>

<p>In [7]:</p>

<pre><code class="language-py">dfd = dfd.set_index('Date')
</code></pre>

<p>Take a look at the first few rows of the dataframe</p>

<p>In [8]:</p>

<pre><code class="language-py">dfd.head()
</code></pre>

<p><img src="https://miro.medium.com/max/177/1*udBNNodZwgus2AiRKyGbbQ.png" alt="" /></p>

<p>Sort the dataframe by date field</p>

<p>In [9]:</p>

<pre><code class="language-py">dfd = dfd.sort_index()
</code></pre>

<p>Create 2 new dataframes to hold the monthly average and yearly averages</p>

<p>In [10]:</p>

<pre><code class="language-py">dfm = dfd.resample('M').mean()  
dfy = dfd.resample('Y').mean()
</code></pre>

<p>Take a look at the monthly average price. Notice that after sorting the initial rows go all the way back to 1957.</p>

<p>In [11]:</p>

<pre><code class="language-py">dfm.head()
</code></pre>

<p><img src="https://miro.medium.com/max/165/1*X7jDTC27vV68M9Gl43GQHw.png" alt="" /></p>

<p>S&amp;P 500 closed today Nov. 6, 2018 at 2747.62. What is the monthly return today had one unit been purchased monthly starting at the very first month that we have data for?</p>

<p>In [12]:</p>

<pre><code class="language-py">tday = 2747.62dfm['Return'] = (tday - dfm['Close'])/dfm['Close']*100
</code></pre>

<p>So if one had bought one unit of S&amp;P 500 back in 1957 then it would at today’s price return 6138%.</p>

<p>In [13]:</p>

<pre><code class="language-py">dfm.head()
</code></pre>

<p><img src="https://miro.medium.com/max/255/1*pTyQtGoT1o4N9TibZyuEtA.png" alt="" /></p>

<p>We calculated the returns for every day that we have data for in our dataframe dating back to 1957. Over the past 30 year period here is the return of a single unit of S&amp;P 500 over time as of Nov. 6, 2018.</p>

<p>In [29]:</p>

<pre><code class="language-py">dfm.iloc[-360:,1].plot()
</code></pre>

<p><img src="https://miro.medium.com/max/392/1*pEfsf2y0sK7R5fxIaXFvmw.png" alt="" /></p>

<p>Now let us explore the yearly average data</p>

<p>In [15]:</p>

<pre><code class="language-py">dfy.head()
</code></pre>

<p><img src="https://miro.medium.com/max/162/1*7Nnj1Txfi6RMUUqWjB-uRQ.png" alt="" /></p>

<p>The chart above is useful to show the distribution of return over time. It confirms our intuition that returns are higher if stocks are held over a longer period and gradually decline as we hold them for lesser periods.</p>

<p>It will be interesting to see how much the five, ten, fifteen, twenty, twenty five and thirty year returns have changed over time. For this we will use the yearly average data.</p>

<p>In [16]:</p>

<pre><code class="language-py">dfy['5y'] = dfy['Close'].shift(5)
</code></pre>

<p>In [17]:</p>

<pre><code class="language-py">dfy['10y'] = dfy['Close'].shift(10)  
dfy['15y'] = dfy['Close'].shift(15)  
dfy['20y'] = dfy['Close'].shift(20)  
dfy['25y'] = dfy['Close'].shift(25)  
dfy['30y'] = dfy['Close'].shift(30)
</code></pre>

<p>Create a new dataframe to calculate the five year returns over time</p>

<p>In [18]:</p>

<pre><code class="language-py">fiveyearreturn = dfy[['Close','5y']].dropna()  
fiveyearreturn['Return'] = (fiveyearreturn['Close'] - fiveyearreturn['5y'])/fiveyearreturn['5y']*100
</code></pre>

<p>Create a boxplot and a kde plot of 5 year returns. The vast majority of the 5 year returns are above zero, which means that more often than not, it is hard to lose money in the market if held over a 5 year period. Although there are some years with negative returns. So had the index been purchased during some months, you could still be in the red after 5 years!</p>

<p>In [19]:</p>

<pre><code class="language-py">plt.figure(figsize=(12,6))  
ax = plt.subplot(121)  
fiveyearreturn['Return'].plot(kind='box')ax = plt.subplot(122)  
fiveyearreturn['Return'].plot(kind='kde')
</code></pre>

<p><img src="https://miro.medium.com/max/728/1*XJMhB1tavRN6LvHHwLKOvQ.png" alt="" /></p>

<pre><code class="language-py">tenyearreturn = dfy[['Close','10y']].dropna()  
tenyearreturn['Return'] = (tenyearreturn['Close'] - tenyearreturn['10y'])/tenyearreturn['10y']*100
</code></pre>

<p>A look at the 10 year returns shows that holding S&amp;P 500 index over 10 years shows a largely positive returns, with a median return of 85%. Vast majority of the returns were over 100%. In some years the returns were above 300% while in others it may have been below 0%!</p>

<p>In [21]:</p>

<pre><code class="language-py">plt.figure(figsize=(12,6))  
ax = plt.subplot(121)  
tenyearreturn['Return'].plot(kind='box')  
ax = plt.subplot(122)  
tenyearreturn['Return'].plot(kind='kde')
</code></pre>

<p><img src="https://miro.medium.com/max/30/1*TCorVs6j1-zTe3TsaYHDvA.png?q=20" alt="" /></p>

<p><img src="https://miro.medium.com/max/712/1*TCorVs6j1-zTe3TsaYHDvA.png" alt="" /></p>

<p>Repeating this exercise for 15, 20, 25 and 30 years will provide the following plots:</p>

<p><img src="https://miro.medium.com/max/718/1*QVAlfyiREfSAXaIoeCAa4Q.png" alt="" /></p>

<p>15 Years</p>

<p><img src="https://miro.medium.com/max/30/1*atx1phMQwSPgiu0NB-SLDw.png?q=20" alt="" /></p>

<p><img src="https://miro.medium.com/max/716/1*atx1phMQwSPgiu0NB-SLDw.png" alt="" /></p>

<p>20 Years</p>

<p><img src="https://miro.medium.com/max/30/1*D-0vpCRHAlegRJQf3Y-1ww.png?q=20" alt="" /></p>

<p><img src="https://miro.medium.com/max/726/1*D-0vpCRHAlegRJQf3Y-1ww.png" alt="" /></p>

<p>25 Years</p>

<p><img src="https://miro.medium.com/max/30/1*9CaSGp3mlQ_U27vg4fePaA.png?q=20" alt="" /></p>

<p><img src="https://miro.medium.com/max/717/1*9CaSGp3mlQ_U27vg4fePaA.png" alt="" /></p>

<p>30 Years</p>

<pre><code class="language-py">combinedreturn = pd.concat([fiveyearreturn['Return'], tenyearreturn['Return'],   
          fifteenyearreturn['Return'], twentyyearreturn['Return'],   
          x25yearreturn['Return'], thirtyyearreturn['Return']],axis=1, keys=['5y', '10y', '15y', '20y', '25y', '30y'])
</code></pre>

<p>Here is a side by side box plot of returns over 5, 10, 15, 20, 25 and 30 year periods.</p>

<p>In [28]:</p>

<pre><code class="language-py">combinedreturn.plot(kind='box', figsize=(8,6))
</code></pre>

<p><img src="https://miro.medium.com/max/544/1*5bYYSZ0jKw9hweZGKnB_Xw.png" alt="" /></p>

<p>Combined Returns for 5,10,15,20,25 and 30 Year Returns</p>

<p>This chart aligns with our understanding of the markets that keeping money over longer term has a greater chance of producing returns and lesser chance of losing money, however some people may have had better success with some of their 20 year investments than those that they bought at the wrong time and held for longer than 20 years.</p>

<p>So what are those periods when the five year returns were negative? Some of these years are familiar such as 2003, 2009 etc.</p>

<p><img src="https://miro.medium.com/max/152/1*txbP12Vg54XlcD-CaV9Nag.png" alt="" /></p>

<p>Years with Negative 5 year returns</p>

<p><img src="https://miro.medium.com/max/157/1*Ml4zkN3EqepJ95Ywy8d57g.png" alt="" /></p>

<p>Years with Negative 10 year returns</p>

<h2 id="the-real-question-is-if-we-were-to-buy-the-s-p-500-today-will-we-be-under-the-water-in-5-or-10-years">The real question is if we were to buy the S&amp;P 500 today, will we be under the water in 5 or 10 years?</h2>

<p>Take 2010 and 10 years prior to 2010. What did S&amp;P do during this period?</p>

<p><img src="https://miro.medium.com/max/513/1*lZuMmKODkFUMk8YIbciOpg.png" alt="" /></p>

<p>My son is 10 years from college. If I invest 10,000 in S&amp;P today and 10 years from now when he is ready for college, and my S&amp;P stock is worth 8000, then that could have a significant impact on our finances 10 years from now.</p>

<p>But the S&amp;P need not look like this. Could it look like the 10 years leading up to 2000.</p>

<p><img src="https://miro.medium.com/max/515/1*DDpqBewIT1uhz1HMzJZh2w.png" alt="" /></p>

<p>Now someone in 1991 would have done well in the market over a 10 year period.</p>

<p>Now let us look at the period from 2008 onward and compare it side by side with the period from 1991 through 2000. The returns have been spectacular in both periods, especially 2009 onward. The similarity is uncanny.</p>

<p><img src="https://miro.medium.com/max/748/1*_0bhK_4a4B5wj6JrnMZYWw.png" alt="" /></p>

<p>So it is quite possible that the S&amp;P will look like the 2000 to 2010 period in the next 10 years which means there is a good chance that the stock market will yield a lower return 10 years from now.</p>

<blockquote>
<p><a href="https://medium.com/@rajivsresearch/exploration-of-s-p-500-index-using-pandas-and-matplotlib-48271c833365">Source</a>.</p>
</blockquote>
</article>

      <div class="book-footer justify-between">
  

  

  
  <div>
    <a class="flex align-center" href="https://github.com/alex-shpak/hugo-book/edit/master/exampleSite/content/docs%5cArticles%5cdata-science%5cfinance%5cexploration-stock-index.md" target="_blank">
      <img src="/library/tutorials/svg/edit.svg" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>
  

</div>

      
    </div>

    
  

  <aside class="book-toc levels-3 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#exploration-of-s-p-500-index-using-pandas-and-matplotlib">Exploration of S&amp;P 500 Index Using Pandas and Matplotlib</a>
<ul>
<li><a href="#the-real-question-is-if-we-were-to-buy-the-s-p-500-today-will-we-be-under-the-water-in-5-or-10-years">The real question is if we were to buy the S&amp;P 500 today, will we be under the water in 5 or 10 years?</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
</body>

</html>
